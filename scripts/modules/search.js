var q=".body";var D="#message",w="#search-modal-content",b=".element",M="element--active";var O=".element__contacts",I="element__contacts--open",U=".element__counter",h="element__counter--active";var g=".column__element",l=".message",E=".message__name",u=".message__position",m=".message__phone",x=".contact-table",y=".js-delete-contact-button",d=".js-edit-contact-button";var B="#edit-popup-content",V="#popup-name",G="#popup-position",F="#popup-phone";var $=".modal",k=".modal__title",K=".modal__body",Y=".modal__input",A=".modal__search-area",j=".modal__button-show";var f=class{constructor(e,o){this.counterElement=e,this.contactsContainer=o,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(h),e.classList.add(M)):(this.counterElement.classList.remove(h),e.classList.remove(M))),this.counterElement.textContent=this.count.toString()}};function W(t){if(localStorage.getItem(t))try{let o=localStorage.getItem(t);return o?JSON.parse(o):[]}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",o),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return[]}function J(t,e){localStorage.setItem(t,JSON.stringify(e))}var z="contacts",p=W(z);function T(){return p}function Z({name:t,position:e,phone:o}){p=p.filter(n=>n.name!==t||n.position!==e||n.phone!==o),J(z,p)}function Q(t){return p.filter(({name:e,position:o,phone:n})=>e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase().includes(t.toLowerCase())||n.includes(t))}var X=t=>t.key==="Escape";var s=document.querySelector($),tt=document.querySelector(q);function L(t){s.showModal(),tt.style.overflow="hidden";let e=s.querySelector(K);e.innerHTML="";let o=t.content.cloneNode(!0);e.appendChild(o),s.querySelector("input").focus(),document.addEventListener("keydown",_)}function et(){s.close(),tt.style.overflow="auto",document.removeEventListener("keydown",_)}function _(t){X(t)&&(t.preventDefault(),et())}var ot=document.querySelector(B),N,H,R,ct=null;function v(t){ot&&L(ot);let e=s.querySelector(k);e&&(e.textContent="Edit contact"),ct=t,N=s.querySelector(V),H=s.querySelector(G),R=s.querySelector(F),N&&H&&R&&(N.value=t.name,H.value=t.position,R.value=t.phone),s.querySelector("input").focus(),document.addEventListener("keydown",_)}var S={};function P({name:t,position:e,phone:o}){let r=document.querySelector(D).content.querySelector(l)?.cloneNode(!0);if(!r)return;let a=r.querySelector(E),i=r.querySelector(u),C=r.querySelector(m);return!a||!i||!C?null:(a.textContent=t,i.textContent=e,C.textContent=o,r)}function at(t,e){e.innerHTML="",t.forEach(({name:o,position:n,phone:c})=>{let r=P({name:o,position:n,phone:c});r&&e.append(r)})}function lt(t,e){let o=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(g);if(o){let n=o.querySelector(O);at(e,n);let c=o.querySelector(U);S[t]||(S[t]=new f(c,n)),S[t].count=e.length,S[t].update()}}function nt(t){let o=t.target.closest(l);if(!o)return;let n=o.querySelector(E)?.textContent??"",c=o.querySelector(u)?.textContent??"",r=o.querySelector(m)?.textContent??"";Z({name:n,position:c,phone:r}),o.remove();let a=n[0].toUpperCase(),i=T().filter(C=>C.name[0].toUpperCase()===a);lt(a,i)}function rt(t){let e=t.target;if(e.closest(g)){let o=e.closest(b);if(!o)return;let n=o.querySelector(O);if(!n)return;n.classList.toggle(I),n.classList.contains(I)?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight="0"}}document.querySelector(x)?.addEventListener("click",t=>{let e=t.target;if(e.closest(y)){nt(t);return}if(e.closest(d)){let o=e.closest(l),n=o.querySelector(E)?.textContent??"",c=o.querySelector(u)?.textContent??"",r=o.querySelector(m)?.textContent??"";v({name:n,position:c,phone:r})}rt(t)});document.querySelector(x)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let o=t.target;if(o.matches(y)){nt(t);return}if(o.closest(d)){let n=o.closest(l),c=n.querySelector(E)?.textContent??"",r=n.querySelector(u)?.textContent??"",a=n.querySelector(m)?.textContent??"";v({name:c,position:r,phone:a})}rt(t)}});var it=document.querySelector(w);function st(t,e){if(e.innerHTML="",t.length===0){e.textContent="No results found";return}t.forEach(({name:o,position:n,phone:c})=>{let r=P({name:o,position:n,phone:c});r&&e.appendChild(r)})}function Et(t,e){t.addEventListener("input",()=>{let o=t.value.trim().toLowerCase();if(o){let n=Q(o);st(n,e)}else e.innerHTML=""})}function Wt(){L(it);let t=s.querySelector(Y),e=s.querySelector(A);Et(t,e),s.querySelector(j).addEventListener("click",ut)}function ut(){let t=T(),e=s.querySelector(A);st(t,e),s.querySelector("input").focus()}export{Wt as openSearchModal,ut as showAllContacts};
