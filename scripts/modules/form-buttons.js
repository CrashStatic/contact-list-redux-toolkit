var Y=3,W="input--error";function Ht(t,e){t.forEach(o=>{o.classList.remove(W)}),e.textContent=""}function N(t,e,o){t.classList.add(W),e.textContent=o}function vt(t){let e=[];return t.forEach(o=>{o.value.trim()||e.push({input:o,message:"Fill in all fields!"})}),e}function Pt(t,{name:e,position:o,phone:n}){return t.some(r=>r.name?.toLowerCase()===e.toLowerCase()&&r.position?.toLowerCase()===o.toLowerCase()&&r.phone===n)?[{input:null,message:"This contact has already been recorded!"}]:[]}function j(t,e){let o=[],n=/^[a-zA-Z]+$/;return t.value.length<e&&o.push({input:t,message:`Value cannot be shorter than ${e} letters!`}),n.test(t.value)||o.push({input:t,message:"Value must contain English letters!"}),o}function qt(t){return/^\+7 \d{3} \d{3} \d{2} \d{2}$/.test(t.value)?[]:[{input:t,message:"Wrong number!"}]}function R({inputs:t,storage:e,errorMessage:o}){let[n,s,r]=t;Ht(t,o);let a=vt(t);if(a.length>0)return{isValid:!1,errors:a};let l={name:n.value,position:s.value,phone:r.value},i=Pt(e,l);if(i.length>0)return{isValid:!1,errors:i};let S=j(n,Y);if(S.length>0)return{isValid:!1,errors:S};let x=j(s,Y);if(x.length>0)return{isValid:!1,errors:x};let C=qt(r);return C.length>0?{isValid:!1,errors:C}:{isValid:!0,errors:[]}}var J=".body";var z="#message",Z="#search-modal-content",Q=".element",H="element--active";var d=".element__contacts",v="element__contacts--open",M=".element__counter",P="element__counter--active";var m=".column__element",p=".message",f=".message__name",L=".message__position",_=".message__phone",q=".contact-table",D=".js-delete-contact-button",O=".js-edit-contact-button",X=".js-clear-contact-button",tt=".js-search-contact-button",et="#edit-popup-content",ot="#popup-name",nt="#popup-position",rt="#popup-phone";var st=".modal",ct=".modal__title",at=".modal__body",lt=".modal__input",w=".modal__search-area",it=".modal__button-show";var Et=".form",ut="name",mt="position",pt="phone",Tt=".form__error",Ct=".form__buttons";var T=class{constructor(e,o){this.counterElement=e,this.contactsContainer=o,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(P),e.classList.add(H)):(this.counterElement.classList.remove(P),e.classList.remove(H))),this.counterElement.textContent=this.count.toString()}};function dt(t){if(localStorage.getItem(t))try{let o=localStorage.getItem(t);return o?JSON.parse(o):[]}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",o),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return[]}function I(t,e){localStorage.setItem(t,JSON.stringify(e))}var h="contacts",E=dt(h);function u(){return E}function ft({name:t,position:e,phone:o}){let n={name:t,position:e,phone:o};E.push(n),I(h,E)}function Lt({name:t,position:e,phone:o}){E=E.filter(n=>n.name!==t||n.position!==e||n.phone!==o),I(h,E)}function _t(t){return E.filter(({name:e,position:o,phone:n})=>e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase().includes(t.toLowerCase())||n.includes(t))}function St(){E=[],I(h,E)}var Mt=t=>t.key==="Escape";var c=document.querySelector(st),Ot=document.querySelector(J);function g(t){c.showModal(),Ot.style.overflow="hidden";let e=c.querySelector(at);e.innerHTML="";let o=t.content.cloneNode(!0);e.appendChild(o),c.querySelector("input").focus(),document.addEventListener("keydown",y)}function It(){c.close(),Ot.style.overflow="auto",document.removeEventListener("keydown",y)}function y(t){Mt(t)&&(t.preventDefault(),It())}var ht=document.querySelector(et),B,b,U,Dt=null;function V(t){ht&&g(ht);let e=c.querySelector(ct);e&&(e.textContent="Edit contact"),Dt=t,B=c.querySelector(ot),b=c.querySelector(nt),U=c.querySelector(rt),B&&b&&U&&(B.value=t.name,b.value=t.position,U.value=t.phone),c.querySelector("input").focus(),document.addEventListener("keydown",y)}var A={};function F({name:t,position:e,phone:o}){let r=document.querySelector(z).content.querySelector(p)?.cloneNode(!0);if(!r)return;let a=r.querySelector(f),l=r.querySelector(L),i=r.querySelector(_);return!a||!l||!i?null:(a.textContent=t,l.textContent=e,i.textContent=o,r)}function wt(t,e){e.innerHTML="",t.forEach(({name:o,position:n,phone:s})=>{let r=F({name:o,position:n,phone:s});r&&e.append(r)})}function gt(t,e){let o=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(m);if(o){let n=o.querySelector(d);wt(e,n);let s=o.querySelector(M);A[t]||(A[t]=new T(s,n)),A[t].count=e.length,A[t].update()}}function yt({contact:t,letterElement:e,shouldSave:o=!0}){o&&ft(t);let n=e.querySelector("[data-id]")?.textContent?.toUpperCase()??"",s=u().filter(r=>r.name[0].toUpperCase()===n);gt(n,s)}function At(t){let o=t.target.closest(p);if(!o)return;let n=o.querySelector(f)?.textContent??"",s=o.querySelector(L)?.textContent??"",r=o.querySelector(_)?.textContent??"";Lt({name:n,position:s,phone:r}),o.remove();let a=n[0].toUpperCase(),l=u().filter(i=>i.name[0].toUpperCase()===a);gt(a,l)}function xt(t){let e=t.target;if(e.closest(m)){let o=e.closest(Q);if(!o)return;let n=o.querySelector(d);if(!n)return;n.classList.toggle(v),n.classList.contains(v)?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight="0"}}document.querySelector(q)?.addEventListener("click",t=>{let e=t.target;if(e.closest(D)){At(t);return}if(e.closest(O)){let o=e.closest(p),n=o.querySelector(f)?.textContent??"",s=o.querySelector(L)?.textContent??"",r=o.querySelector(_)?.textContent??"";V({name:n,position:s,phone:r})}xt(t)});document.querySelector(q)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let o=t.target;if(o.matches(D)){At(t);return}if(o.closest(O)){let n=o.closest(p),s=n.querySelector(f)?.textContent??"",r=n.querySelector(L)?.textContent??"",a=n.querySelector(_)?.textContent??"";V({name:s,position:r,phone:a})}xt(t)}});var Bt=document.querySelector(Z);function Nt(t,e){if(e.innerHTML="",t.length===0){e.textContent="No results found";return}t.forEach(({name:o,position:n,phone:s})=>{let r=F({name:o,position:n,phone:s});r&&e.appendChild(r)})}function bt(t,e){t.addEventListener("input",()=>{let o=t.value.trim().toLowerCase();if(o){let n=_t(o);Nt(n,e)}else e.innerHTML=""})}function Rt(){g(Bt);let t=c.querySelector(lt),e=c.querySelector(w);bt(t,e),c.querySelector(it).addEventListener("click",Ut)}function Ut(){let t=u(),e=c.querySelector(w);Nt(t,e),c.querySelector("input").focus()}var G=document.getElementById(ut),$=document.getElementById(mt),k=document.getElementById(pt);function Vt(){let t=G.value.trim(),e=$.value.trim(),o=k.value.trim(),n=document.querySelector(Tt),s=[G,$,k],r=u(),{isValid:a,errors:l}=R({inputs:s,storage:r,errorMessage:n});if(!a){l.forEach(({input:C,message:K})=>{C?N(C,n,K):n.textContent=K});return}let i=t[0].toUpperCase(),S=document.querySelector(`[data-id="${i.toLowerCase()}"]`)?.closest(m);yt({contact:{name:t,position:e,phone:o},letterElement:S}),G.value="",$.value="",k.value=""}function Ft(){document.querySelectorAll(m).forEach(t=>{let e=t.querySelector(d);e.innerHTML="";let o=t.querySelector(M);new T(o,e).reset()}),St()}var Gt=document.querySelector(Et);Gt.addEventListener("submit",t=>{t.preventDefault(),Vt()});var $t=document.querySelector(Ct);$t.addEventListener("click",t=>{let e=t.target;e.matches(X)&&Ft(),e.matches(tt)&&Rt()});export{G as nameInput,k as phoneInput,$ as positionInput};
