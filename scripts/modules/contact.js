var b=".body";var w="#message";var U=".element",M="element--active";var C=".element__contacts",I="element__contacts--open",V=".element__counter",g="element__counter--active",B=".element__message",d=".column__element",p=".message",i=".message__name",E=".message__position",u=".message__phone",h=".contact-table",x=".js-delete-contact-button",f=".js-edit-contact-button";var G="#edit-popup-content",F="#popup-name",$="#popup-position",k="#popup-phone";var K=".modal",Y=".modal__title",j=".modal__body";var _=class{constructor(e,o){this.counterElement=e,this.contactsContainer=o,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(g),e.classList.add(M)):(this.counterElement.classList.remove(g),e.classList.remove(M))),this.counterElement.textContent=this.count.toString()}};function J(t){if(localStorage.getItem(t))try{let o=localStorage.getItem(t);return o?JSON.parse(o):[]}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",o),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return[]}function y(t,e){localStorage.setItem(t,JSON.stringify(e))}var N="contacts",T=J(N);function L(){return T}function W({name:t,position:e,phone:o}){let n={name:t,position:e,phone:o};T.push(n),y(N,T)}function z({name:t,position:e,phone:o}){T=T.filter(n=>n.name!==t||n.position!==e||n.phone!==o),y(N,T)}var Z=t=>t.key==="Escape";var a=document.querySelector(K),Q=document.querySelector(b);function X(t){a.showModal(),Q.style.overflow="hidden";let e=a.querySelector(j);e.innerHTML="";let o=t.content.cloneNode(!0);e.appendChild(o),a.querySelector("input").focus(),document.addEventListener("keydown",S)}function tt(){a.close(),Q.style.overflow="auto",document.removeEventListener("keydown",S)}function S(t){Z(t)&&(t.preventDefault(),tt())}var et=document.querySelector(G),A,P,v,ct=null;function R(t){et&&X(et);let e=a.querySelector(Y);e&&(e.textContent="Edit contact"),ct=t,A=a.querySelector(F),P=a.querySelector($),v=a.querySelector(k),A&&P&&v&&(A.value=t.name,P.value=t.position,v.value=t.phone),a.querySelector("input").focus(),document.addEventListener("keydown",S)}var O={};function lt({name:t,position:e,phone:o}){let r=document.querySelector(w).content.querySelector(p)?.cloneNode(!0);if(!r)return;let s=r.querySelector(i),l=r.querySelector(E),m=r.querySelector(u);return!s||!l||!m?null:(s.textContent=t,l.textContent=e,m.textContent=o,r)}function it(t,e){e.innerHTML="",t.forEach(({name:o,position:n,phone:c})=>{let r=lt({name:o,position:n,phone:c});r&&e.append(r)})}function ot(t,e){let o=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(d);if(o){let n=o.querySelector(C);it(e,n);let c=o.querySelector(V);O[t]||(O[t]=new _(c,n)),O[t].count=e.length,O[t].update()}}function Ut({contact:t,letterElement:e,shouldSave:o=!0}){o&&W(t);let n=e.querySelector("[data-id]")?.textContent?.toUpperCase()??"",c=L().filter(r=>r.name[0].toUpperCase()===n);ot(n,c)}function nt(t){let o=t.target.closest(p);if(!o)return;let n=o.querySelector(i)?.textContent??"",c=o.querySelector(E)?.textContent??"",r=o.querySelector(u)?.textContent??"";z({name:n,position:c,phone:r}),o.remove();let s=n[0].toUpperCase(),l=L().filter(m=>m.name[0].toUpperCase()===s);ot(s,l)}function at(t,e){let o=t.name[0].toUpperCase(),n=document.querySelector(`[data-id="${o.toLowerCase()}"]`)?.closest(d);n&&n.querySelector(C).querySelectorAll(B).forEach(s=>{let l=s.querySelector(i)?.textContent??"",m=s.querySelector(E)?.textContent??"",st=s.querySelector(u)?.textContent??"";if(l===t.name&&m===t.position&&st===t.phone){let H=s.querySelector(i),q=s.querySelector(E),D=s.querySelector(u);H&&q&&D&&(H.textContent=e.name,q.textContent=e.position,D.textContent=e.phone)}})}function rt(t){let e=t.target;if(e.closest(d)){let o=e.closest(U);if(!o)return;let n=o.querySelector(C);if(!n)return;n.classList.toggle(I),n.classList.contains(I)?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight="0"}}document.querySelector(h)?.addEventListener("click",t=>{let e=t.target;if(e.closest(x)){nt(t);return}if(e.closest(f)){let o=e.closest(p),n=o.querySelector(i)?.textContent??"",c=o.querySelector(E)?.textContent??"",r=o.querySelector(u)?.textContent??"";R({name:n,position:c,phone:r})}rt(t)});document.querySelector(h)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let o=t.target;if(o.matches(x)){nt(t);return}if(o.closest(f)){let n=o.closest(p),c=n.querySelector(i)?.textContent??"",r=n.querySelector(E)?.textContent??"",s=n.querySelector(u)?.textContent??"";R({name:c,position:r,phone:s})}rt(t)}});export{Ut as addContact,nt as deleteContact,lt as renderContactElement,it as renderContacts,at as updateContact};
